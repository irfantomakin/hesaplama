<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<link rel="apple-touch-icon" href="image/icon2.png">
<link rel="icon" type="image/png" href="image/icon2.png">
<meta name="apple-mobile-web-app-title" content="SÃ¼re">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>ðŸ•’ SÃ¼re Hesaplama - Pro Dashboard</title>

<style>
  :root {
    --bg: #f0f2f5;
    --card: #ffffff;
    --border: #e2e8f0;
    --danger: #ef4444;
    --success: #1b5e20;
    --accent: #2563eb;
    --dark: #1e293b;
    --text-muted: #64748b;
    --safeTop: env(safe-area-inset-top, 0px);
    --safeBottom: env(safe-area-inset-bottom, 0px);
  }

  body {
    margin: 0;
    padding: 12px 12px calc(12px + var(--safeBottom));
    background: var(--bg);
    font-family: 'Inter', -apple-system, sans-serif;
    max-width: 1100px;
    margin-inline: auto;
    color: var(--dark);
  }

  /* GÄ°ZLÄ° ALANLAR */
  #sub1, #sub2, #clearSub1, #clearSub2, .top-diff, .time-icon {
    display: none !important;
  }

  .toolbar {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin: calc(6px + var(--safeTop)) 0 20px;
  }
  .btn {
    padding: 12px 24px;
    border-radius: 14px;
    border: 1px solid var(--border);
    background: #fff;
    font-weight: 800;
    cursor: pointer;
    min-width: 170px;
    transition: all 0.2s ease;
    color: var(--text-muted);
  }
  .btn.active { background: var(--dark); color: #fff; border-color: var(--dark); }

  .areas { display: flex; gap: 20px; align-items: flex-start; }
  .area {
    flex: 1;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 24px;
    padding: 20px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.05);
    display: flex;
    flex-direction: column;
  }

  .titlebar {
    display: grid;
    grid-template-columns: 100px 1fr;
    gap: 12px;
    margin-bottom: 15px;
  }

  .total-mini, .comment-pill {
    display: flex;
    flex-direction: column;
    padding: 15px;
    border-radius: 18px;
    background: #f8fafc;
    border: 8px solid #f1f5f9;
    transition: all 0.3s ease;
  }

  /* DURUM RENKLERÄ° */
  .status-ok { border-color: var(--success) !important; color: var(--success) !important; }
  .status-bad { border-color: var(--danger) !important; color: var(--danger) !important; }

  .tlabel, .tag { font-size: 11px; font-weight: 800; color: var(--text-muted); text-transform: uppercase; margin-bottom: 4px; }
  .tvalue { font-size: 25px; font-weight: 900; color: var(--accent); line-height: 1; }

  #commentVal1, #commentVal2, #manualVal1, #manualVal2 {
    font-size: 45px;
    font-weight: 900;
    line-height: 1;
    color: inherit;
  }

  .diff-row { display: flex; flex-direction: column; gap: 12px; margin-bottom: 15px; }

  .manual-input {
    width: 100%;
    padding: 12px;
    font-size: 20px;
    font-weight: 800;
    border-radius: 16px;
    border: 2px solid #e2e8f0;
    background: #fff;
    text-align: center;
    box-sizing: border-box;
  }

  .list { margin-top: 15px; max-height: 400px; overflow-y: auto; border-top: 1px solid #f1f5f9; padding-right: 5px; }
  .row { display: flex; align-items: center; gap: 10px; padding: 8px 0; border-bottom: 1px dashed #edf2f7; }
  .idx { width: 30px; font-weight: 800; color: #cbd5e1; }
  
  .time-input {
    flex: 1;
    padding: 10px;
    border-radius: 10px;
    border: 1px solid #e2e8f0;
    font-size: 18px;
    font-weight: 700;
    text-align: center;
    transition: all 0.2s;
  }
  
  /* DOLU KUTU SÄ°YAH OLSUN */
  .time-input.filled { background: var(--dark) !important; color: #fff !important; border-color: var(--dark) !important; }

  .icon-btn { width: 40px; height: 40px; border-radius: 12px; border: 1px solid #e2e8f0; background: #fff; font-size: 18px; font-weight: 900; cursor: pointer; }
  .clear-all { background: #fff; color: var(--danger); border: 1px solid #fecdd3; padding: 12px; border-radius: 14px; font-weight: 900; cursor: pointer; margin-bottom: 10px; }

  @media (max-width:900px){
    .areas { display: block; }
    .area { display: none; border-radius: 0; min-height: 80vh; }
    .area.active { display: flex; }
    .titlebar { grid-template-columns: 1fr; }
    #commentVal1, #commentVal2, #manualVal1, #manualVal2 { font-size: 68px; }
  }
</style>
</head>

<body>

<div class="toolbar">
  <button class="btn active" id="tab1">Reklamdan Ã–nce</button>
  <button class="btn" id="tab2">Reklamdan Sonra</button>
</div>

<div class="areas">
  <div class="area active" data-area="1">
    <div class="titlebar">
      <div class="total-mini">
        <span class="tlabel">TOPLAM:</span>
        <span class="tvalue" id="total1">â€”:â€”</span>
      </div>
      <div class="comment-pill" id="pill1">
        <span class="tag">HABER + SAAT</span>
        <span id="commentVal1">â€”:â€”</span>
      </div>
    </div>
    <button class="clear-all" id="clearArea1">Hepsini Sil</button>
    <div class="diff-row">
      <input id="manual1" class="manual-input" placeholder="HH:MM:SS" inputmode="numeric">
      <div class="comment-pill" id="manualPill1">
        <span class="tag">YORUM</span>
        <span id="manualVal1">â€”:â€”</span>
      </div>
    </div>
    <div class="list" id="area1"></div>
  </div>

  <div class="area" data-area="2">
    <div class="titlebar">
      <div class="total-mini">
        <span class="tlabel">TOPLAM:</span>
        <span class="tvalue" id="total2">â€”:â€”</span>
      </div>
      <div class="comment-pill" id="pill2">
        <span class="tag">HABER + SAAT</span>
        <span id="commentVal2">â€”:â€”</span>
      </div>
    </div>
    <button class="clear-all" id="clearArea2">Hepsini Sil</button>
    <div class="diff-row">
      <input id="manual2" class="manual-input" placeholder="HH:MM:SS" inputmode="numeric">
      <div class="comment-pill" id="manualPill2">
        <span class="tag">YORUM</span>
        <span id="manualVal2">â€”:â€”</span>
      </div>
    </div>
    <div class="list" id="area2"></div>
  </div>
</div>

<script>
  const total1 = document.getElementById("total1"), total2 = document.getElementById("total2");
  const manual1 = document.getElementById("manual1"), manual2 = document.getElementById("manual2");
  const manualVal1 = document.getElementById("manualVal1"), manualVal2 = document.getElementById("manualVal2");
  const allInputs = [];

  // Dolu input kontrolÃ¼ (Siyah arka plan iÃ§in)
  function updateFilledState(input) {
    if(input.value && input.value.trim() !== "") input.classList.add("filled");
    else input.classList.remove("filled");
  }

  // MM:SS Otomatik Format
  function autoFormatMMSS(v) {
    v = v.replace(/\D/g,"");
    if(!v) return "";
    if(v.length <= 2) return `0:${v.padStart(2,"0")}`;
    let m = parseInt(v.slice(0,-2),10) || 0, s = parseInt(v.slice(-2),10) || 0;
    m += Math.floor(s/60); s = s % 60;
    return `${m}:${String(s).padStart(2,"0")}`;
  }

  // HH:MM:SS Manuel Format
  function formatManualHMS(v) {
    v = v.replace(/\D/g,"");
    if(v.length === 6) return `${v.slice(0,2)}:${v.slice(2,4)}:${v.slice(4,6)}`;
    if(v.length === 4) return `${v.slice(0,2)}:${v.slice(2,4)}:00`;
    return v;
  }

  function toSecondsMMSS(v) {
    if(!v || !v.includes(":")) return 0;
    const [m,s] = v.split(":");
    return (parseInt(m,10)||0)*60 + (parseInt(s,10)||0);
  }

  function fromSecondsMMSS(sec) {
    sec = Math.max(0, sec);
    return `${String(Math.floor(sec/60)).padStart(2,"0")}:${String(sec%60).padStart(2,"0")}`;
  }

  function secondsToHMS(sec) {
    sec = ((sec % 86400) + 86400) % 86400;
    return `${String(Math.floor(sec/3600)).padStart(2,"0")}:${String(Math.floor((sec%3600)/60)).padStart(2,"0")}:${String(sec%60).padStart(2,"0")}`;
  }

  function parseHMS(v) {
    v = v.replace(/\D/g,"");
    if(v.length === 6) return parseInt(v.slice(0,2))*3600 + parseInt(v.slice(2,4))*60 + parseInt(v.slice(4,6));
    if(v.length === 4) return parseInt(v.slice(0,2))*3600 + parseInt(v.slice(2,4))*60;
    return null;
  }

  function calculateTotals() {
    let a1=0, a2=0;
    document.querySelectorAll("#area1 input.time-input").forEach(i=> a1 += toSecondsMMSS(i.value));
    document.querySelectorAll("#area2 input.time-input").forEach(i=> a2 += toSecondsMMSS(i.value));

    total1.textContent = a1 > 0 ? fromSecondsMMSS(a1) : "â€”:â€”";
    total2.textContent = a2 > 0 ? fromSecondsMMSS(a2) : "â€”:â€”";

    const now = new Date();
    const nowS = now.getHours()*3600 + now.getMinutes()*60 + now.getSeconds();

    [1,2].forEach(n => {
      const aTotal = n===1 ? a1 : a2;
      const hPlusS = nowS + aTotal;
      const pill = document.getElementById("pill"+n);
      const mInput = n===1 ? manual1 : manual2;
      const mVal = parseHMS(mInput.value);
      const mPill = document.getElementById("manualPill"+n);
      const mDisplay = n===1 ? manualVal1 : manualVal2;

      document.getElementById("commentVal"+n).textContent = secondsToHMS(hPlusS);

      if(mVal !== null) {
        const diff = mVal - hPlusS;
        mDisplay.textContent = fromSecondsMMSS(Math.abs(diff));
        
        // RENK MANTIÄžI: Hedefi (manuel saati) geÃ§erse KIRMIZI, yoksa YEÅžÄ°L
        if(diff >= 0) {
          pill.className = "comment-pill status-ok";
          mPill.className = "comment-pill status-ok";
        } else {
          pill.className = "comment-pill status-bad";
          mPill.className = "comment-pill status-bad";
        }
      } else {
        pill.className = "comment-pill";
        mPill.className = "comment-pill";
        mDisplay.textContent = "â€”:â€”";
      }
    });
  }

  function wireInput(inp) {
    // OTOMATÄ°K SEÃ‡ME (PC ve MOBÄ°L Ä°Ã‡Ä°N)
    inp.onfocus = function() { setTimeout(()=> this.select(), 50); };
    inp.onclick = function() { this.select(); };

    inp.oninput = () => {
      let v = inp.value.replace(/\D/g,"");
      // 3 hane girilince (Ã¶rn: 300) otomatik 3:00 yap ve aÅŸaÄŸÄ± geÃ§
      if(v.length === 3) {
        inp.value = autoFormatMMSS(v);
        updateFilledState(inp);
        calculateTotals();
        const next = allInputs[allInputs.indexOf(inp) + 1];
        if(next) next.focus();
      }
      updateFilledState(inp);
      calculateTotals();
    };
    
    inp.onblur = () => { 
      if(inp.value) inp.value = autoFormatMMSS(inp.value); 
      updateFilledState(inp); 
      calculateTotals(); 
    };
  }

  function createAreaInputs(id, count) {
    const c = document.getElementById(id);
    for(let i=1; i<=count; i++) {
      const row = document.createElement("div");
      row.className = "row";
      row.innerHTML = `<div class="idx">${i}.</div><input class="time-input" placeholder="00:00" inputmode="numeric"><button class="icon-btn" type="button">âœ•</button>`;
      const inp = row.querySelector("input");
      wireInput(inp);
      row.querySelector("button").onclick = () => { inp.value = ""; updateFilledState(inp); calculateTotals(); };
      c.appendChild(row);
      allInputs.push(inp);
    }
  }

  // Manuel giriÅŸ iÃ§in de tÄ±klayÄ±nca seÃ§me ekle
  [manual1, manual2].forEach(m => {
    m.onfocus = function() { setTimeout(()=> this.select(), 50); };
    m.onclick = function() { this.select(); };
    m.onblur = () => { m.value = formatManualHMS(m.value); calculateTotals(); };
    m.oninput = () => calculateTotals();
  });

  createAreaInputs("area1", 13); createAreaInputs("area2", 7);
  
  document.getElementById("tab1").onclick = () => { document.querySelector('.area[data-area="1"]').classList.add('active'); document.querySelector('.area[data-area="2"]').classList.remove('active'); document.getElementById("tab1").classList.add('active'); document.getElementById("tab2").classList.remove('active'); };
  document.getElementById("tab2").onclick = () => { document.querySelector('.area[data-area="2"]').classList.add('active'); document.querySelector('.area[data-area="1"]').classList.remove('active'); document.getElementById("tab2").classList.add('active'); document.getElementById("tab1").classList.remove('active'); };

  document.getElementById("clearArea1").onclick = () => { document.querySelectorAll("#area1 input").forEach(i=>{i.value=""; updateFilledState(i);}); calculateTotals(); };
  document.getElementById("clearArea2").onclick = () => { document.querySelectorAll("#area2 input").forEach(i=>{i.value=""; updateFilledState(i);}); calculateTotals(); };

  setInterval(calculateTotals, 1000);
</script>
</body>
</html>
